<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>M2 Docs - Build & CI</title>
  <meta name="description" content="Build, CI, and release operations for M2.">
  <link rel="icon" type="image/png" href="app-icon.png">
  <link rel="apple-touch-icon" href="app-icon.png">
  <link rel="stylesheet" href="styles.css">
  <script src="main.js" defer></script>
</head>
<body>
  <header class="topbar">
    <a class="brand" href="index.html" aria-label="M2 docs home">
      <img class="site-icon" src="app-icon.png" alt="M2 app icon">
      <span>M2 Engineering Docs</span>
    </a>
    <button class="nav-toggle" type="button" data-nav-toggle aria-expanded="false" aria-controls="site-nav">Menu</button>
    <nav id="site-nav" class="top-nav" data-site-nav aria-label="Primary">
      <a href="index.html" data-nav="index.html">Home</a>
      <a href="architecture.html" data-nav="architecture.html">Architecture</a>
      <a href="services-data.html" data-nav="services-data.html">Services & Data</a>
      <a href="build-ci.html" data-nav="build-ci.html">Build & CI</a>
    </nav>
  </header>

  <main class="docs-layout">
    <aside class="toc card">
      <p class="toc-title">On This Page</p>
      <nav>
        <a href="#requirements">Requirements</a>
        <a href="#build-local">Local Build Recipes</a>
        <a href="#run">Run Targets</a>
        <a href="#ci">CI Workflows</a>
        <a href="#checks">Verification Checklist</a>
        <a href="#troubleshooting">Troubleshooting</a>
        <a href="#release">Release Checklist</a>
      </nav>
    </aside>

    <article class="doc-content">
      <section id="requirements" class="card section">
        <p class="eyebrow">Operations</p>
        <h1>Build & CI</h1>
        <ul>
          <li>No network dependency for core app build path.</li>
        </ul>
      </section>

      <section id="build-local" class="card section">
        <h2>Local Build Recipes</h2>
        <div class="command-grid">
          <article class="command-box">
            <p>Simulator build</p>
            <code>xcodebuild -project "M2.xcodeproj" -scheme "M2" -configuration Debug -sdk iphonesimulator -destination 'generic/platform=iOS Simulator' CODE_SIGNING_ALLOWED=NO CODE_SIGNING_REQUIRED=NO clean build</code>
            <button class="copy-btn" data-copy="xcodebuild -project \"M2.xcodeproj\" -scheme \"M2\" -configuration Debug -sdk iphonesimulator -destination 'generic/platform=iOS Simulator' CODE_SIGNING_ALLOWED=NO CODE_SIGNING_REQUIRED=NO clean build">Copy</button>
          </article>
          <article class="command-box">
          </article>
          <article class="command-box">
            <p>Extension target build</p>
            <code>xcodebuild -project "M2.xcodeproj" -scheme "M2LiveActivityExtension" -configuration Debug -sdk iphonesimulator -destination 'generic/platform=iOS Simulator' CODE_SIGNING_ALLOWED=NO CODE_SIGNING_REQUIRED=NO clean build</code>
            <button class="copy-btn" data-copy="xcodebuild -project \"M2.xcodeproj\" -scheme \"M2LiveActivityExtension\" -configuration Debug -sdk iphonesimulator -destination 'generic/platform=iOS Simulator' CODE_SIGNING_ALLOWED=NO CODE_SIGNING_REQUIRED=NO clean build">Copy</button>
          </article>
        </div>
      </section>

      <section id="run" class="card section">
        <h2>Run Targets</h2>
        <table>
          <thead>
            <tr>
              <th>Target</th>
              <th>Destination</th>
              <th>Notes</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>M2</code></td>
              <td>iPhone Simulator / Device</td>
              <td>Primary mobile runtime.</td>
            </tr>
            <tr>
              <td><code>M2</code></td>
            </tr>
            <tr>
              <td><code>M2LiveActivityExtension</code></td>
              <td>Built through host app</td>
              <td>Sleep timer activity rendering.</td>
            </tr>
          </tbody>
        </table>
      </section>

      <section id="ci" class="card section">
        <h2>CI Workflows</h2>
        <ul>
          <li><code>.github/workflows/ios-ci.yml</code>: app + extension build validation.</li>
          <li><code>.github/workflows/ios.yml</code>: baseline iOS build workflow.</li>
        </ul>
      </section>

      <section id="checks" class="card section">
        <h2>Verification Checklist</h2>
        <ul class="clean-list">
          <li>Playlists tab opens My Playlists hub from clickable heading/arrow.</li>
          <li>Hover overlay on playlist cards works with play + pin action.</li>
        </ul>
      </section>

      <section id="troubleshooting" class="card section">
        <h2>Troubleshooting</h2>
        <table>
          <thead>
            <tr>
              <th>Symptom</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>CoreSimulator warnings in build logs</td>
              <td>If build still finishes with <code>BUILD SUCCEEDED</code>, treat as environment noise.</td>
            </tr>
            <tr>
              <td>Stale derived data artifacts</td>
              <td>Use local <code>-derivedDataPath .derivedData</code> and clean build.</td>
            </tr>
            <tr>
            </tr>
          </tbody>
        </table>
      </section>

      <section id="release" class="card section">
        <h2>Release Checklist</h2>
        <ol>
          <li>Smoke-test playback, playlists, favorites, and sleep timer.</li>
          <li>Update docs pages if behavior or keys changed.</li>
          <li>Tag and push release commit.</li>
        </ol>
      </section>
    </article>
  </main>

  <footer class="footer">
    <p>Build and operations guide.</p>
    <p id="generated-at"></p>
  </footer>
</body>
</html>
